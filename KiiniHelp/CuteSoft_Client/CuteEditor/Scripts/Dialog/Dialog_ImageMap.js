var OxOe47c=["contains","parentNode","selection","document","type","None","Text","body","rangeCount","window","Control","anchorOffset","childNodes","anchorNode","isCollapsed","focusNode","length","nodeType","nodeName","INPUT","TEXTAREA","BUTTON","IMG","SELECT","TABLE","position","style","absolute","relative","top","contentWindow","contentDocument","parentWindow","id","frames","frameElement","//TODO:frame contentWindow not found?","iframe","editor","img","onload","src","","src_cetemp","contentEditable","designMode","on","clearAttributes","marginTop","0","marginLeft","color","black","background","white","unselectable","2D-Position","LiveResize","innerHTML","outerHTML","MAP","name","useMap","#","areas","href","target","alt","coords",",","\x3Cimg id=\x27myIMAGE","\x27 border=1 src=\x27Load.ashx?type=image\x26file=space.gif\x27 title=\x27[[AddLinktoImageMap]]\x27 style=\x27position:absolute;left:","px;top:","px;width:","px;height:","px;z-index:","\x27\x3E","Load.ashx?Type=Dialog\x26file=MapLink.htm\x26","dialogWidth:380px;dialogHeight:200px;help:no;scroll:no;status:no;resizable:0;","UseStandardDialog","1","\x26Dialog=Standard","Theme=","Theme","\x26","DNNArg","zoom","width","height","\x27  border=1 src=\x27Load.ashx?type=image\x26file=space.gif\x27 title=\x27[[AddLinktoImageMap]]\x27 style=\x27position:absolute;z-index:",";width:20;height:20;left:",";top:","myIMAGE","\x3Carea shape=\x27rect\x27 coords=\x27","\x27","href=\x27","\x27 ","target=\x27","alt=\x27","\x3E","PasteHTML","\x3Cmap name=\x27","\x3C/map\x3E","off","AutoMap","display","img_zoom_in","none","img_zoom_out","img_bestfit","img_actualsize"];function Element_Contains(element,Ox183){if(!Browser_IsOpera()){if(element[OxOe47c[0]]){return element.contains(Ox183);} ;} ;for(;Ox183!=null;Ox183=Ox183[OxOe47c[1]]){if(element==Ox183){return true;} ;} ;return false;} ;function Window_CreateSelectionRange(Ox1a8){var Ox228;if(Browser_UseIESelection()){var Ox136=Ox1a8[OxOe47c[3]][OxOe47c[2]];if(Ox136[OxOe47c[4]]==OxOe47c[5]||Ox136[OxOe47c[4]]==OxOe47c[6]){Ox228=Ox136.createRange();} else {Ox228=document[OxOe47c[7]].createTextRange();Ox228.moveToElement(Ox136.createRange().item(0));} ;} else {var Ox136=Ox1a8.getSelection();if(Ox136[OxOe47c[8]]==0){Ox228=Ox1a8[OxOe47c[3]].createRange();} else {Ox228=Ox136.getRangeAt(0).cloneRange();} ;} ;Ox228[OxOe47c[9]]=Ox1a8;return Ox228;} ;function Window_GetSelectionNode(Ox1a8){var Ox183=Window_GetSelectionNode_Core(Ox1a8);if(Ox183==Ox1a8[OxOe47c[3]][OxOe47c[7]]){return null;} ;if(!Element_Contains(Ox1a8[OxOe47c[3]].body,Ox183)){return null;} ;return Ox183;} ;function Window_GetSelectionNode_Core(Ox1a8){var Ox136;if(Browser_UseIESelection()){Ox136=Ox1a8[OxOe47c[3]][OxOe47c[2]];if(Ox136[OxOe47c[4]]==OxOe47c[5]||Ox136[OxOe47c[4]]==OxOe47c[6]){return Ox136.createRange().parentElement();} ;return Ox136.createRange().item(0);} ;var Ox136=Ox1a8.getSelection();if(Window_GetSelectionType(Ox1a8)==OxOe47c[10]){return Ox136[OxOe47c[13]][OxOe47c[12]][Ox136[OxOe47c[11]]];} ;if(Ox136[OxOe47c[14]]){return Ox136[OxOe47c[13]];} ;if(Ox136[OxOe47c[13]]==Ox136[OxOe47c[15]]){return Ox136[OxOe47c[13]];} ;var p=Ox136[OxOe47c[13]];var Ox343=p[OxOe47c[12]];for(var i=0;i<Ox343[OxOe47c[16]];i++){var Ox217=Ox343.item(i);if(Ox136.containsNode(Ox217,true)){if(i!=0&&Ox136.containsNode(Ox343.item(i-1),false)){continue ;} ;if(i<Ox343[OxOe47c[16]]-1&&Ox136.containsNode(Ox343.item(i+1),false)){continue ;} ;return Ox217;} ;} ;if(Ox136[OxOe47c[8]]==1){return Range_GetParentNode(Window_CreateSelectionRange(Ox1a8));} ;if(!Element_Contains(Ox1a8[OxOe47c[3]].body,Ox136.anchorNode)){return null;} ;return Element_GetSameParent(Ox136.anchorNode,Ox136.focusNode);} ;function Window_GetSelectionElement(Ox1a8){var Ox183=Window_GetSelectionNode(Ox1a8);if(Ox183==null){return null;} ;if(Ox183[OxOe47c[17]]==1){return Ox183;} ;return Ox183[OxOe47c[1]];} ;function Window_GetSelectionType(Ox1a8){if(Browser_UseIESelection()){return Ox1a8[OxOe47c[3]][OxOe47c[2]][OxOe47c[4]];} ;var Ox136=Ox1a8.getSelection();if(Ox136[OxOe47c[14]]){return OxOe47c[6];} ;if(Ox136[OxOe47c[13]]!=Ox136[OxOe47c[15]]){return OxOe47c[6];} ;var p=Ox136[OxOe47c[13]];var Ox343=p[OxOe47c[12]];for(var i=0;i<Ox343[OxOe47c[16]];i++){var Ox217=Ox343.item(i);if(Ox217[OxOe47c[17]]!=1){continue ;} ;if(Ox136.containsNode(Ox217,true)){if(i!=0&&Ox136.containsNode(Ox343.item(i-1),false)){continue ;} ;if(i<Ox343[OxOe47c[16]]-1&&Ox136.containsNode(Ox343.item(i+1),false)){continue ;} ;if(Element_IsBlockControl(Ox217)){return OxOe47c[10];} ;return OxOe47c[6];} ;} ;return OxOe47c[6];} ;function Element_IsBlockControl(element){var name=element[OxOe47c[18]];if(name==OxOe47c[19]){return true;} ;if(name==OxOe47c[20]){return true;} ;if(name==OxOe47c[21]){return true;} ;if(name==OxOe47c[22]){return true;} ;if(name==OxOe47c[23]){return true;} ;if(name==OxOe47c[24]){return true;} ;var Ox126=element[OxOe47c[26]][OxOe47c[25]];if(Ox126==OxOe47c[27]||Ox126==OxOe47c[28]){return true;} ;return false;} ;function Window_GetDialogTop(Ox1a8){return Ox1a8[OxOe47c[29]];} ;function Frame_GetContentWindow(Ox349){if(Ox349[OxOe47c[30]]){return Ox349[OxOe47c[30]];} ;if(Ox349[OxOe47c[31]]){if(Ox349[OxOe47c[31]][OxOe47c[32]]){return Ox349[OxOe47c[31]][OxOe47c[32]];} ;} ;var Ox1a8;if(Ox349[OxOe47c[33]]){Ox1a8=window[OxOe47c[34]][Ox349[OxOe47c[33]]];if(Ox1a8){return Ox1a8;} ;} ;var len=window[OxOe47c[34]][OxOe47c[16]];for(var i=0;i<len;i++){Ox1a8=window[OxOe47c[34]][i];if(Ox1a8[OxOe47c[35]]==Ox349){return Ox1a8;} ;if(Ox1a8[OxOe47c[3]]==Ox349[OxOe47c[31]]){return Ox1a8;} ;} ;Debug_Todo(OxOe47c[36]);} ;var iframe=Window_GetElement(window,OxOe47c[37],true);var iframe_win=Frame_GetContentWindow(iframe);var obj=Window_GetDialogArguments(window);var editor=obj[OxOe47c[38]];var editwin=obj[OxOe47c[9]];var editdoc=obj[OxOe47c[3]];var oImg=obj[OxOe47c[39]];var oMap=null;var aMapName= new Array();var aLeft= new Array();var aTop= new Array();var aWidth= new Array();var aHeight= new Array();var aHref= new Array();var aTarget= new Array();var aTitle= new Array();var aCoords= new Array();window[OxOe47c[40]]=function window_onload(){var src;src=oImg.getAttribute(OxOe47c[41])+OxOe47c[42];if(oImg.getAttribute(OxOe47c[43])){src=oImg.getAttribute(OxOe47c[43])+OxOe47c[42];} ;oImg[OxOe47c[41]]=src;if(Browser_IsWinIE()){iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[44]]=true;} else {iframe_win[OxOe47c[3]][OxOe47c[45]]=OxOe47c[46];iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[44]]=true;} ;iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[47]];iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[48]]=OxOe47c[49];iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[50]]=OxOe47c[49];iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[51]]=OxOe47c[52];iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[53]]=OxOe47c[54];oImg[OxOe47c[55]]=OxOe47c[46];if(Browser_IsWinIE()){iframe_win[OxOe47c[3]].execCommand(OxOe47c[56],true,true);iframe_win[OxOe47c[3]].execCommand(OxOe47c[57],true,true);} ;iframe_win.focus();if(Browser_IsWinIE()){iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[58]]=oImg[OxOe47c[59]];} else {iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[58]]=outerHTML(oImg);} ;var Ox357=editdoc[OxOe47c[7]].getElementsByTagName(OxOe47c[60]);for(var i=0;i<Ox357[OxOe47c[16]];i++){aMapName[i]=Ox357[i][OxOe47c[61]].toUpperCase();} ;var Ox358=oImg[OxOe47c[62]];if(Ox358!=OxOe47c[42]){Ox358=Ox358.toUpperCase();for(var i=0;i<Ox357[OxOe47c[16]];i++){if((OxOe47c[63]+aMapName[i])==Ox358){oMap=Ox357[i];} ;} ;} ;if(oMap){for(var i=0;i<oMap[OxOe47c[64]][OxOe47c[16]];i++){aHref[i]=oMap[OxOe47c[64]][i][OxOe47c[65]];aTarget[i]=oMap[OxOe47c[64]][i][OxOe47c[66]];aTitle[i]=oMap[OxOe47c[64]][i][OxOe47c[67]];aCoords[i]=oMap[OxOe47c[64]][i][OxOe47c[68]];var Oxee=aCoords[i].split(OxOe47c[69]);aLeft[i]=parseInt(Oxee[0]);aTop[i]=parseInt(Oxee[1]);aWidth[i]=parseInt(Oxee[2])-aLeft[i];aHeight[i]=parseInt(Oxee[3])-aTop[i];iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[58]]+=OxOe47c[70]+i+OxOe47c[71]+aLeft[i]+OxOe47c[72]+aTop[i]+OxOe47c[73]+aWidth[i]+OxOe47c[74]+aHeight[i]+OxOe47c[75]+(i+1)+OxOe47c[76];} ;} ;} ;function SearchSelectionElement(Ox35a){var body=iframe_win[OxOe47c[3]][OxOe47c[7]];for(var Ox43=Window_GetSelectionElement(iframe_win);Element_Contains(body,Ox43);Ox43=Ox43[OxOe47c[1]]){if(Ox43[OxOe47c[18]]==Ox35a){return Ox43;} ;} ;return null;} ;function Addlink(){var img=SearchSelectionElement(OxOe47c[22]);if(!img){return ;} ;function Ox35d(arr){if(arr){aHref[Ox35f]=arr[0];aTarget[Ox35f]=arr[1];aTitle[Ox35f]=arr[2];} ;} ;var Ox35e=img[OxOe47c[33]];var Ox35f=parseInt(Ox35e.substr(7));var obj={editor:editor,href:aHref[Ox35f],target:aTarget[Ox35f],title:aTitle[Ox35f]};editor.SetNextDialogWindow(window);editor.ShowDialog(Ox35d,OxOe47c[77]+GetDialogQueryString(),obj,OxOe47c[78]);} ;function GetDialogQueryString(){var Ox120=OxOe47c[42];if(editor.GetScriptProperty(OxOe47c[79])==OxOe47c[80]){Ox120=OxOe47c[81];} ;return OxOe47c[82]+editor.GetScriptProperty(OxOe47c[83])+Ox120+OxOe47c[84]+editor.GetScriptProperty(OxOe47c[85]);} ;function do_Close(){Window_SetDialogReturnValue(window,null);Window_CloseDialog(window);} ;function Zoom_In(){if(iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[86]]!=0){iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[86]]*=1.2;} else {iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[86]]=1.2;} ;} ;function Zoom_Out(){if(iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[86]]!=0){iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[86]]*=0.8;} else {iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[86]]=0.8;} ;} ;function BestFit(){if(!oImg){return ;} ;var Ox73=280;var Ox74=290;iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[86]]=1/Math.max(oImg[OxOe47c[87]]/Ox74,oImg[OxOe47c[88]]/Ox73);} ;function Actualsize(){iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[26]][OxOe47c[86]]=1;} ;function newMap(){var Ox27=aHref[OxOe47c[16]];var Oxe1=(oImg[OxOe47c[87]]-20)*0.5;var Ox2d=(oImg[OxOe47c[88]]-20)*0.5;aHref[Ox27]=OxOe47c[42];aTarget[Ox27]=OxOe47c[42];aTitle[Ox27]=OxOe47c[42];iframe_win[OxOe47c[3]][OxOe47c[7]][OxOe47c[58]]+=OxOe47c[70]+Ox27+OxOe47c[89]+(Ox27+1)+OxOe47c[90]+Oxe1+OxOe47c[91]+Ox2d+OxOe47c[76];iframe_win.scrollBy(0,0);iframe_win.focus();} ;function do_insert(){var b=false;for(var i=0;i<aHref[OxOe47c[16]];i++){var obj=Window_GetElement(iframe_win,OxOe47c[92]+i,false);if(obj){b=true;} ;} ;if(b){var Ox283=OxOe47c[42];for(var i=0;i<aHref[OxOe47c[16]];i++){var obj=Window_GetElement(iframe_win,OxOe47c[92]+i,false);if(obj){var Ox365=parseInt(obj[OxOe47c[26]].left);var Ox366=parseInt(obj[OxOe47c[26]].top);var Ox367=parseInt(obj[OxOe47c[26]].width);var Ox368=parseInt(obj[OxOe47c[26]].height);var Ox369=Ox365+Ox367;var Ox36a=Ox366+Ox368;Ox283+=OxOe47c[93]+Ox365+OxOe47c[69]+Ox366+OxOe47c[69]+Ox369+OxOe47c[69]+Ox36a+OxOe47c[94];if(aHref[i]!=OxOe47c[42]){Ox283+=OxOe47c[95]+aHref[i]+OxOe47c[96];} ;if((aTarget[i]!=OxOe47c[42])&&aTarget[i]){Ox283+=OxOe47c[97]+aTarget[i]+OxOe47c[96];} ;if(aTitle[i]!=OxOe47c[42]&&aTitle[i]!=null){Ox283+=OxOe47c[98]+aTitle[i]+OxOe47c[96];} ;Ox283+=OxOe47c[99];} ;} ;if(oMap){oMap[OxOe47c[58]]=Ox283;} else {var Ox358=getAutoMapName();oImg[OxOe47c[62]]=OxOe47c[63]+Ox358;editor.ExecCommand(OxOe47c[100],false,OxOe47c[101]+Ox358+OxOe47c[76]+Ox283+OxOe47c[102]);} ;} else {if(oMap){if(Browser_IsWinIE()){oMap[OxOe47c[59]]=OxOe47c[42];} ;} ;oImg[OxOe47c[62]]=OxOe47c[42];} ;oImg[OxOe47c[55]]=OxOe47c[103];oImg.removeAttribute(OxOe47c[55]);if(!Browser_IsWinIE()){editor.InsertElement(oImg);} ;Window_CloseDialog(window);} ;function getAutoMapName(){for(var i=1;true;i++){var Ox120=OxOe47c[104]+i;if(isValidMapName(Ox120)){return Ox120;} ;} ;} ;function isValidMapName(Ox24){Ox24=Ox24.toUpperCase();for(var i=0;i<aMapName[OxOe47c[16]];i++){if(aMapName[i]==Ox24){return false;} ;} ;return true;} ;function do_Close(){oImg.removeAttribute(OxOe47c[55]);Window_CloseDialog(window);} ;if(!Browser_IsWinIE()){Window_GetElement(window,OxOe47c[106],true)[OxOe47c[26]][OxOe47c[105]]=OxOe47c[107];Window_GetElement(window,OxOe47c[108],true)[OxOe47c[26]][OxOe47c[105]]=OxOe47c[107];Window_GetElement(window,OxOe47c[109],true)[OxOe47c[26]][OxOe47c[105]]=OxOe47c[107];Window_GetElement(window,OxOe47c[110],true)[OxOe47c[26]][OxOe47c[105]]=OxOe47c[107];} ;